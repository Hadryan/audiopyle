sudo: required
language: python
python:
    - "3.6"

services:
  - docker

before_script:
  - chmod u+x **/*.sh
  - scripts/install_os_deps.sh
  - scripts/install_build_deps.sh

script:
  - scripts/run_type_check.sh
  - scripts/run_unit_tests.sh
  - scripts/build_base_image.sh
  - scripts/build_app_images.sh
  - scripts/build_test_image.sh
  - scripts/run_integration_tests.sh

after_success:
  - scripts/run_static_analysis.sh
  - if [ "$TRAVIS_BRANCH" == "master" ]; then
    scripts/push-base-image.sh;
    fi
